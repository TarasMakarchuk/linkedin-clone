<ion-card class="container">
  <div class="select-connection">

    <div class="top-panel">
      <div class="heading">
        <ion-text color="dark">Messaging</ion-text>
      </div>
      <div>
        <ion-button
          style="margin-right: -30px;"
          shape="round"
          color="dark"
          fill="clear"
        >
          <ion-icon name="ellipsis-horizontal-outline"></ion-icon>
        </ion-button>
        <ion-button shape="round" color="dark" fill="clear">
          <ion-icon name="create-outline"></ion-icon>
        </ion-button>
      </div>
    </div>

    <div
      *ngFor="let friend of friends; let idx = index"
      (click)="openConversation(friend, idx)"
      class="friend"
      [ngClass]="{ 'selected-conversation': selectedConversationIndex === idx }"
    >
      <ion-grid>
        <ion-row class="ion-align-items-center ion-justify-content-center">
          <ion-col size="auto">
            <ion-avatar>
              <ion-img
                *ngIf="friend.imagePath; else defaultUserAvatar"
                [src]="'http://localhost:5001/api/user/image/' + friend.imagePath"
              ></ion-img>
              <ng-template #defaultUserAvatar>
                <ion-img
                  *ngIf="friend.imagePath; else defaultUserAvatar"
                  [src]="'http://localhost:5001/api/user/image/default-avatar.png'"
                ></ion-img>
              </ng-template>
            </ion-avatar>
          </ion-col>
          <ion-col>
            <ion-card-title>{{ friend.firstName }} {{ friend.lastName }}</ion-card-title>
            <ion-card-subtitle>Full stack developer</ion-card-subtitle>
          </ion-col>
        </ion-row>
      </ion-grid>
    </div>

  </div>

  <div class="chat">
    <div class="top-panel">
      <div class="friend-name-role">
        <ion-text style="font-weight: 500" color="dark">Firstname Lastname</ion-text>
        <ion-text color="dark">Full Stack developer</ion-text>
      </div>
      <div>
        <ion-button
          style="margin-right: -30px;"
          shape="round"
          color="dark"
          fill="clear"
        >
          <ion-icon name="ellipsis-horizontal-outline"></ion-icon>
        </ion-button>
        <ion-button shape="round" color="dark" fill="clear">
          <ion-icon name="videocam"></ion-icon>
        </ion-button>
      </div>
    </div>

    <ion-grid class="chat-messages">
      <ion-row
        *ngFor="let message of messages"
        class="ion-align-items-center"
      >
        <ion-col style="height: 70px">
          <ion-avatar style="margin-bottom: 50px">
            <ion-img
              *ngIf="userImagePath"
              [src]="userImagePath"
            ></ion-img>
          </ion-avatar>
        </ion-col>
        <ion-col>
          <p style="color: gray; margin-left: -150px;">{{ message }}</p>
        </ion-col>
      </ion-row>
    </ion-grid>

    <form #form="ngForm" (ngSubmit)="onSubmit()">
      <ion-item>
        <ion-textarea ngModel type="text" name="message" placeholder="Write a message..." required></ion-textarea>
      </ion-item>
      <ion-grid>
        <ion-row class="ion-align-items-center ion-justify-content-between">
          <span>
            <ion-button style="margin-right: -20px" shape="round" color="dark" fill="clear">
               <ion-icon name="image-outline"></ion-icon>
            </ion-button>
            <ion-button style="margin-right: -20px" shape="round" color="dark" fill="clear">
               <ion-icon name="document-outline"></ion-icon>
            </ion-button>
            <ion-button style="margin-right: -20px" shape="round" color="dark" fill="clear">
               <ion-icon name="film-outline"></ion-icon>
            </ion-button>
            <ion-button shape="round" color="dark" fill="clear">
               <ion-icon name="happy-outline"></ion-icon>
            </ion-button>
          </span>
          <span>
            <ion-button
              style="width: 55px"
              [disabled]="!form.valid"
              type="submit"
              shape="round"
            >
              Send
            </ion-button>
            <ion-button shape="round" color="dark" fill="clear">
               <ion-icon name="ellipsis-horizontal-outline"></ion-icon>
            </ion-button>
          </span>
        </ion-row>
      </ion-grid>
    </form>

  </div>
</ion-card>
